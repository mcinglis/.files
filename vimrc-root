
" Use Vim defaults, not Vi defaults.
" This must be first, because it changes other settings.
set nocompatible

let mapleader=' '

filetype plugin indent on


"""""""""""""""""""
" OPTIONS
"""""""""""""""""""

" Enable syntax highlighting, but don't clobber existing ':highlight's.
syntax enable

" Use Unicode UTF-8 by default.
set encoding=utf-8

" Remember more commands and searches
set history=10000

" Don't let files impose configuration settings.
set nomodeline

" Create swap files in the first possible directory in this list.
set directory=~/.vim/swaps,/tmp

" Make a backup before overwriting a file, in the first possible directory.
set backup
set backupdir=~/.vim/backups,/tmp

" Save undo histories for files.
set undofile
set undodir=~/.vim/undos,/tmp

" Remember the cursor position and folds in windows (but not options).
set viewoptions=cursor,folds
set viewdir=~/.vim/views
autocmd BufWinLeave ?* silent! mkview
autocmd BufWinEnter ?* silent! loadview


""" EDITING

" Always use '\n' for line breaks.
set fileformat=unix

" Allow backspacing over everything in insert mode.
set backspace=indent,eol,start

" Insert two spaces after a '.', '?' and '!' with a join command.
set joinspaces


""" WHITESPACE

" Smarter automatic indenting when starting a new line.
set autoindent
set smartindent

" Always insert tabs (and indents) as spaces.
set expandtab

" Number of spaces to use for each auto-indentation step.
set shiftwidth=4

" Backspacing over a <Tab> will replace it with 'shiftwidth' spaces.
set softtabstop=-1


""" NAVIGATION

" Enhanced command-line completion.
set wildmenu

" When pressing <Tab>, autocomplete to the longest common string, and if
" there's more than one match, list them all.
set wildmode=longest,list

" File patterns to ignore when autoexpanding file names.  This also effects
" the Command-T plugin.
set wildignore+=*.swp,*.swo,*.o,*.pyc,*.class,.git/*,.svn/*,*.dep.mk

" When switching between buffers, jump to the first open window that contains
" the specified buffer (if there is one).
set switchbuf=useopen

" Allow buffers to be hidden without saving them.
set hidden

" Minimum number of screen lines to keep above and below the cursor.
set scrolloff=3


""" DISPLAY

" Use a colorscheme optimal for a dark background.
set background=dark

" Allow for 256 colors.
set t_Co=256

" Show the line and column number of the cursor position.
set ruler

" Always display windows' status lines.
set laststatus=2

" Show the incoming command in the last line of the screen.
set showcmd

" Number of screen lines to use for the command line.
set cmdheight=1

" Highlight this column.
"set colorcolumn=80

" When a bracket is inserted, briefly jump to the matching one.
set showmatch

" Highlight the line of the cursor.
"set cursorline

" Only display the line with tab page labels when there are multiple tabs.
set showtabline=1

" Minimum number of columns for the current window.  If the current window
" is smaller, its size is increased at the expense of other windows.
set winwidth=20

" Don't display whitespace characters (by default).
set nolist


""" SEARCHING

" Ignore case for all-lowercase search patterns.
set ignorecase
set smartcase

" Show matches while typing the search pattern.
set incsearch

" Highlight search pattern matches.
set hlsearch



"""""""""""""""""""
" AUTOCOMMANDS
"""""""""""""""""""

" Give files with .txt extensions their own filetypes, but only if they
" haven't already been given a filetype.
autocmd BufNewFile,BufRead *.txt,README,INSTALL,NEWS,TODO,LICENSE
            \ if &filetype == "" | set filetype=text | endif

autocmd BufEnter,BufRead *.h
            \ setlocal filetype=c

autocmd FileType c,cpp,java
            \ setlocal textwidth=80 |
            \ setlocal commentstring=//\ %s

autocmd FileType python
            \ setlocal textwidth=80

autocmd FileType make
            \ setlocal noexpandtab

autocmd FileType html
            \ setlocal shiftwidth=2

" For filetypes used for writing, wrap long lines by breaking at words.
autocmd FileType text,markdown,gitcommit,rst
            \ setlocal wrap |
            \ setlocal linebreak |
            \ setlocal textwidth=80

autocmd FileType gitcommit
            \ setlocal textwidth=72


"""""""""""""""""""
" MAPPINGS
"""""""""""""""""""

" Switch to the last-edited buffer with Ctrl-E.
noremap <C-e> :e#<CR>

" Save the file by pressing Enter in normal mode.
noremap <CR> :write<CR>

" Edit the Vim configuration file.
nnoremap <Leader>e :edit ~/.vimrc<CR>

